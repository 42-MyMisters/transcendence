{"ast":null,"code":"import * as socket from '../socket/chat.socket';\nimport config from 'config';\nexport async function DoFollow(userUid, doOrUndo, followingList, setFollowingList, userList) {\n  let status = -1;\n  const resource = doOrUndo ? \"follow\" : \"unfollow\";\n  const url = config.get('public-url.backend');\n  await fetch(url + '/user/' + `${resource}/${userUid}`, {\n    credentials: \"include\",\n    method: \"POST\"\n  }).then(response => {\n    status = response.status;\n    switch (response.status) {\n      case 201:\n        {\n          if (doOrUndo) {\n            const tempFollowing = {};\n            tempFollowing[userUid] = {\n              ...userList[userUid]\n            };\n            setFollowingList({\n              ...followingList,\n              ...tempFollowing\n            });\n          } else {\n            const tempFollowing = {\n              ...followingList\n            };\n            delete tempFollowing[userUid];\n            setFollowingList({\n              ...tempFollowing\n            });\n          }\n          break;\n        }\n      default:\n        {\n          throw new Error(`${response.status}`);\n        }\n    }\n  }).catch(error => {\n    console.log(`\\nDoFollow catch_error: ${error} `);\n  });\n  return status;\n}\n_c = DoFollow;\nexport async function GetMyInfo(setUserInfo) {\n  let status = -1;\n  await fetch(`${config.get('public-url.backend')}/user/me`, {\n    credentials: \"include\",\n    method: \"GET\"\n  }).then(response => {\n    switch (response.status) {\n      case 200:\n        {\n          status = 200;\n          return response.json();\n        }\n      default:\n        {\n          throw new Error(`${response.status}`);\n        }\n    }\n  }).then(response => {\n    console.log(`\\nGetMyInfo: ${JSON.stringify(response)}`);\n    response.nickname = response.nickname.split('#', 2)[0];\n    setUserInfo({\n      ...response\n    });\n  }).catch(error => {\n    status = error.message;\n    console.log(`\\nGetMyInfo catch_error: ${error} `);\n  });\n  return status;\n}\n_c2 = GetMyInfo;\nexport async function RefreshToken() {\n  let callback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : () => {};\n  let status = -1;\n  console.log(`in try refresh Token`);\n  await fetch(`${config.get('public-url.backend')}/login/oauth/refresh`, {\n    credentials: \"include\",\n    method: \"POST\",\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n      'Authorization': 'Bearer ' + localStorage.getItem(\"refreshToken\")\n    }\n  }).then(response => {\n    status = response.status;\n    switch (response.status) {\n      case 201:\n        {\n          callback();\n          break;\n        }\n      default:\n        {\n          throw new Error(`${response.status}`);\n        }\n    }\n  }).catch(error => {\n    console.log(`\\nRefreshToken catch_error: ${error} `);\n  });\n  return status;\n}\n_c3 = RefreshToken;\nexport function LogOut(setRefreshToken, navigate, to) {\n  console.log(\"logout\");\n  socket.socket.emit(\"chat-logout\");\n  socket.socket.disconnect();\n  localStorage.clear();\n  setRefreshToken(false);\n  navigate(to);\n}\n_c4 = LogOut;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"DoFollow\");\n$RefreshReg$(_c2, \"GetMyInfo\");\n$RefreshReg$(_c3, \"RefreshToken\");\n$RefreshReg$(_c4, \"LogOut\");","map":{"version":3,"names":["socket","config","DoFollow","userUid","doOrUndo","followingList","setFollowingList","userList","status","resource","url","get","fetch","credentials","method","then","response","tempFollowing","Error","catch","error","console","log","_c","GetMyInfo","setUserInfo","json","JSON","stringify","nickname","split","message","_c2","RefreshToken","callback","arguments","length","undefined","headers","localStorage","getItem","_c3","LogOut","setRefreshToken","navigate","to","emit","disconnect","clear","_c4","$RefreshReg$"],"sources":["/data/front/src/event/api.request.ts"],"sourcesContent":["import { NavigateFunction } from 'react-router-dom';\nimport type { UserType } from '../components/atom/UserAtom';\nimport type * as chatType from '../socket/chat.dto';\nimport * as socket from '../socket/chat.socket';\nimport config from 'config';\n\ntype setUserInfo = React.Dispatch<React.SetStateAction<UserType>>;\n\nexport async function DoFollow(\n\tuserUid: number,\n\tdoOrUndo: boolean,\n\tfollowingList: chatType.userDto,\n\tsetFollowingList: React.Dispatch<React.SetStateAction<chatType.userDto>>,\n\tuserList: chatType.userDto,\n): Promise<number> {\n\n\tlet status = -1;\n\tconst resource = doOrUndo ? \"follow\" : \"unfollow\";\n\tconst url = config.get<string>('public-url.backend');\n\t\n\tawait fetch(url + '/user/' +`${resource}/${userUid}`, {\n\t\tcredentials: \"include\",\n\t\tmethod: \"POST\",\n\t})\n\t\t.then((response) => {\n\t\t\tstatus = response.status;\n\t\t\tswitch (response.status) {\n\t\t\t\tcase 201: {\n\t\t\t\t\tif (doOrUndo) {\n\t\t\t\t\t\tconst tempFollowing: chatType.userDto = {};\n\t\t\t\t\t\ttempFollowing[userUid] = {\n\t\t\t\t\t\t\t...userList[userUid],\n\t\t\t\t\t\t};\n\t\t\t\t\t\tsetFollowingList({ ...followingList, ...tempFollowing });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst tempFollowing = { ...followingList };\n\t\t\t\t\t\tdelete tempFollowing[userUid];\n\t\t\t\t\t\tsetFollowingList({ ...tempFollowing });\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault: {\n\t\t\t\t\tthrow new Error(`${response.status}`);\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconsole.log(`\\nDoFollow catch_error: ${error} `);\n\t\t});\n\n\treturn status;\n}\n\nexport async function GetMyInfo(setUserInfo: setUserInfo): Promise<number> {\n\n\tlet status = -1;\n\n\tawait fetch(`${config.get<string>('public-url.backend')}/user/me`, {\n\t\tcredentials: \"include\",\n\t\tmethod: \"GET\",\n\t})\n\t\t.then((response) => {\n\t\t\tswitch (response.status) {\n\t\t\t\tcase 200: {\n\t\t\t\t\tstatus = 200;\n\t\t\t\t\treturn response.json();\n\t\t\t\t}\n\t\t\t\tdefault: {\n\t\t\t\t\tthrow new Error(`${response.status}`);\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\t.then((response) => {\n\t\t\tconsole.log(`\\nGetMyInfo: ${JSON.stringify(response)}`);\n\t\t\tresponse.nickname = response.nickname.split('#', 2)[0];\n\t\t\tsetUserInfo({ ...response });\n\t\t})\n\t\t.catch((error) => {\n\t\t\tstatus = error.message;\n\t\t\tconsole.log(`\\nGetMyInfo catch_error: ${error} `);\n\t\t});\n\n\treturn status;\n}\n\nexport async function RefreshToken(\n\tcallback = (): any => { }\n): Promise<number> {\n\tlet status = -1;\n\n\tconsole.log(`in try refresh Token`);\n\tawait fetch(`${config.get<string>('public-url.backend')}/login/oauth/refresh`, {\n\t\tcredentials: \"include\",\n\t\tmethod: \"POST\",\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + localStorage.getItem(\"refreshToken\")\n\t\t}\n\t})\n\t\t.then((response) => {\n\t\t\tstatus = response.status;\n\t\t\tswitch (response.status) {\n\t\t\t\tcase 201: {\n\t\t\t\t\tcallback();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault: {\n\t\t\t\t\tthrow new Error(`${response.status}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}).catch((error) => {\n\t\t\tconsole.log(`\\nRefreshToken catch_error: ${error} `);\n\t\t});\n\n\treturn status;\n}\n\nexport function LogOut(\n\tsetRefreshToken: React.Dispatch<React.SetStateAction<boolean>>,\n\tnavigate: NavigateFunction,\n\tto: string\n) {\n\tconsole.log(\"logout\");\n\tsocket.socket.emit(\"chat-logout\");\n\tsocket.socket.disconnect();\n\tlocalStorage.clear();\n\tsetRefreshToken(false);\n\tnavigate(to);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}