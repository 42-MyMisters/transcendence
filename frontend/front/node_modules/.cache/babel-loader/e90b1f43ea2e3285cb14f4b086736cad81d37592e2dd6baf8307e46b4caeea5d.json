{"ast":null,"code":"var _jsxFileName = \"/data/front/src/components/ProfilePage/ChangeImageModal.tsx\",\n  _s = $RefreshSig$();\nimport { useAtom } from \"jotai\";\nimport { UserAtom } from \"../atom/UserAtom\";\nimport { useRef, useState } from \"react\";\nimport { changeImageModalAtom } from \"../../components/atom/ModalAtom\";\nimport { PressKey, AdminLogPrinter } from \"../../event/event.util\";\nimport * as chatAtom from \"../../components/atom/ChatAtom\";\nimport \"../../styles/ChangeImageModal.css\";\nimport config from \"config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ChangeImageModal() {\n  _s();\n  const [changeImageModal, setchangeImageModal] = useAtom(changeImageModalAtom);\n  const [userInfo, setUserInfo] = useAtom(UserAtom);\n  const [newImage, setnewImage] = useState(\"\");\n  const [adminConsole] = useAtom(chatAtom.adminConsoleAtom);\n  const profileRef = useRef(null);\n  PressKey([\"Escape\"], () => {\n    setchangeImageModal(false);\n  });\n  const handleChangeImage = () => {\n    var _profileRef$current, _profileRef$current$f;\n    if ((_profileRef$current = profileRef.current) !== null && _profileRef$current !== void 0 && (_profileRef$current$f = _profileRef$current.files) !== null && _profileRef$current$f !== void 0 && _profileRef$current$f[0]) {\n      var _profileRef$current2;\n      const newImg = URL.createObjectURL((_profileRef$current2 = profileRef.current) === null || _profileRef$current2 === void 0 ? void 0 : _profileRef$current2.files[0]);\n      setnewImage(newImg);\n      AdminLogPrinter(adminConsole, `new Image: ${newImg}`);\n    }\n  };\n  const setNewImage = async () => {\n    var _profileRef$current3, _profileRef$current3$, _profileRef$current4, _profileRef$current4$;\n    const formData = new FormData();\n    formData.append(\"profileImage\", (_profileRef$current3 = profileRef.current) === null || _profileRef$current3 === void 0 ? void 0 : (_profileRef$current3$ = _profileRef$current3.files) === null || _profileRef$current3$ === void 0 ? void 0 : _profileRef$current3$[0]);\n    AdminLogPrinter(adminConsole, (_profileRef$current4 = profileRef.current) === null || _profileRef$current4 === void 0 ? void 0 : (_profileRef$current4$ = _profileRef$current4.files) === null || _profileRef$current4$ === void 0 ? void 0 : _profileRef$current4$[0].name);\n    const url = config.get('public-url.backend');\n    try {\n      const response = await fetch(url + \"/user/profile-img-change\", {\n        credentials: \"include\",\n        method: \"POST\",\n        body: formData\n      });\n      if (response.ok) {\n        let tmp = userInfo;\n        tmp.profileUrl = newImage;\n        setUserInfo(tmp);\n        AdminLogPrinter(adminConsole, response);\n        setchangeImageModal(false);\n      } else {\n        alert(\"파일 업로드에 실패했습니다.\");\n      }\n    } catch (error) {\n      alert(error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ChangeImageModalBG\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ChangeImageModal\",\n      children: [/*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"ChangeImageForm\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"newImage\",\n          children: \"New Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"newImage\",\n          type: \"file\",\n          accept: \".jpg,.jpeg,.png\",\n          multiple: false,\n          onChange: handleChangeImage,\n          ref: profileRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"ChangeImage\",\n        onClick: setNewImage,\n        children: \"Save\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ChangeImageCancel\",\n        onClick: () => setchangeImageModal(false),\n        children: \"Cancel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(ChangeImageModal, \"HAA+BLQP+mnHPoWMNfBqWW8psaE=\", false, function () {\n  return [useAtom, useAtom, useAtom];\n});\n_c = ChangeImageModal;\nvar _c;\n$RefreshReg$(_c, \"ChangeImageModal\");","map":{"version":3,"names":["useAtom","UserAtom","useRef","useState","changeImageModalAtom","PressKey","AdminLogPrinter","chatAtom","config","jsxDEV","_jsxDEV","Fragment","_Fragment","ChangeImageModal","_s","changeImageModal","setchangeImageModal","userInfo","setUserInfo","newImage","setnewImage","adminConsole","adminConsoleAtom","profileRef","handleChangeImage","_profileRef$current","_profileRef$current$f","current","files","_profileRef$current2","newImg","URL","createObjectURL","setNewImage","_profileRef$current3","_profileRef$current3$","_profileRef$current4","_profileRef$current4$","formData","FormData","append","name","url","get","response","fetch","credentials","method","body","ok","tmp","profileUrl","alert","error","children","className","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","id","type","accept","multiple","onChange","ref","onClick","_c","$RefreshReg$"],"sources":["/data/front/src/components/ProfilePage/ChangeImageModal.tsx"],"sourcesContent":["import { useAtom } from \"jotai\";\nimport { UserAtom } from \"../atom/UserAtom\";\nimport { useRef, useState } from \"react\";\nimport { changeImageModalAtom } from \"../../components/atom/ModalAtom\";\nimport { PressKey, AdminLogPrinter } from \"../../event/event.util\";\nimport * as chatAtom from \"../../components/atom/ChatAtom\";\n\nimport \"../../styles/ChangeImageModal.css\";\nimport config from \"config\";\n\nexport default function ChangeImageModal() {\n  const [changeImageModal, setchangeImageModal] = useAtom(changeImageModalAtom);\n  const [userInfo, setUserInfo] = useAtom(UserAtom);\n  const [newImage, setnewImage] = useState(\"\");\n  const [adminConsole] = useAtom(chatAtom.adminConsoleAtom);\n  const profileRef = useRef<HTMLInputElement>(null);\n\n  PressKey([\"Escape\"], () => {\n    setchangeImageModal(false);\n  });\n\n  const handleChangeImage = () => {\n    if (profileRef.current?.files?.[0]) {\n      const newImg = URL.createObjectURL(profileRef.current?.files[0]);\n      setnewImage(newImg);\n      AdminLogPrinter(adminConsole, `new Image: ${newImg}`);\n    }\n  };\n\n  const setNewImage = async () => {\n    const formData = new FormData();\n    formData.append(\"profileImage\", profileRef.current?.files?.[0]!);\n    AdminLogPrinter(adminConsole, profileRef.current?.files?.[0]!.name);\n    const url = config.get<string>('public-url.backend');\n\n    try {\n      const response = await fetch(\n        url + \"/user/profile-img-change\",\n        {\n          credentials: \"include\",\n          method: \"POST\",\n          body: formData,\n        }\n      );\n\n      if (response.ok) {\n        let tmp = userInfo;\n        tmp.profileUrl = newImage;\n        setUserInfo(tmp);\n        AdminLogPrinter(adminConsole, response);\n        setchangeImageModal(false);\n      } else {\n        alert(\"파일 업로드에 실패했습니다.\");\n      }\n    } catch (error) {\n      alert(error);\n    }\n  };\n\n  return (\n    <>\n      <div className=\"ChangeImageModalBG\"></div>\n      <div className=\"ChangeImageModal\">\n        <form className=\"ChangeImageForm\">\n          <label htmlFor=\"newImage\">New Image</label>\n          <input\n            id=\"newImage\"\n            type=\"file\"\n            accept=\".jpg,.jpeg,.png\"\n            multiple={false}\n            onChange={handleChangeImage}\n            ref={profileRef}\n          ></input>\n        </form>\n        <button type=\"submit\" className=\"ChangeImage\" onClick={setNewImage}>\n          Save\n        </button>\n        <button\n          className=\"ChangeImageCancel\"\n          onClick={() => setchangeImageModal(false)}\n        >\n          Cancel\n        </button>\n      </div>\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}