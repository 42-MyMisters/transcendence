{"ast":null,"code":"var _jsxFileName = \"/data/front/src/components/ChatPage/ChatArea.tsx\",\n  _s2 = $RefreshSig$();\nimport \"../../styles/ChatArea.css\";\nimport SpeechBubble from \"../objects/SpeechBubble\";\nimport * as chatAtom from '../atom/ChatAtom';\nimport { UserAtom } from \"../atom/UserAtom\";\nimport { useAtom } from 'jotai';\nimport { useState, useRef, useEffect } from 'react';\nimport * as socket from \"../../socket/chat.socket\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ChatArea() {\n  _s2();\n  var _s = $RefreshSig$(),\n    _roomList$focusRoom2,\n    _roomList$focusRoom2$;\n  const [focusRoom] = useAtom(chatAtom.focusRoomAtom);\n  const [roomList, setRoomList] = useAtom(chatAtom.roomListAtom);\n  const [userList] = useAtom(chatAtom.userListAtom);\n  const [message, setMessage] = useState('');\n  const [userInfo] = useAtom(UserAtom);\n  const [adminConsole] = useAtom(chatAtom.adminConsoleAtom);\n  const defaultText = \"채팅방을 선택해주세요. 방을 만들거나, 참여하면 채팅을 할 수 있습니다.\";\n  const useAutoFocus = () => {\n    _s();\n    const inputRef = useRef(null);\n    useEffect(() => {\n      if (inputRef.current) {\n        inputRef.current.focus();\n      }\n    }, [focusRoom]);\n    return inputRef;\n  };\n  _s(useAutoFocus, \"cBQ6FQ+sf5H+lvNONLKqtm4aeQ8=\");\n  const chatAreaRef = useAutoFocus();\n  const handleSendMessage = () => {\n    const tempMessage = message.trim();\n    if (tempMessage !== '') {\n      var _roomList$focusRoom;\n      if (((_roomList$focusRoom = roomList[focusRoom]) === null || _roomList$focusRoom === void 0 ? void 0 : _roomList$focusRoom.roomType) === 'dm') {\n        socket.emitDM(adminConsole, focusRoom, tempMessage);\n      } else {\n        socket.emitMessage({\n          adminConsole,\n          roomList\n        }, focusRoom, tempMessage);\n      }\n    }\n    setMessage('');\n  };\n  const handleEnterEvent = e => {\n    if (e.key === 'Enter') {\n      handleSendMessage();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ChatAreaBG\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ChatBubbleArea\",\n      children: focusRoom === -1 ? /*#__PURE__*/_jsxDEV(SpeechBubble, {\n        nickName: \"Norminette\",\n        isMe: false,\n        text: defaultText\n      }, \"-42\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 13\n      }, this) : (_roomList$focusRoom2 = roomList[focusRoom]) === null || _roomList$focusRoom2 === void 0 ? void 0 : (_roomList$focusRoom2$ = _roomList$focusRoom2.detail) === null || _roomList$focusRoom2$ === void 0 ? void 0 : _roomList$focusRoom2$.messageList.map(key => /*#__PURE__*/_jsxDEV(SpeechBubble, {\n        // nickName={userList[key.userId]?.userDisplayName}\n        nickName: userList[key.userId].userDisplayName || key.userName,\n        text: key.message,\n        isMe: key.isMe\n      }, key.number, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 15\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      ref: chatAreaRef,\n      className: \"ChatAreaInput\",\n      maxLength: 256,\n      value: message,\n      onChange: e => setMessage(e.target.value),\n      onKeyPress: e => handleEnterEvent(e)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ChatDMImg\",\n      onClick: handleSendMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n}\n_s2(ChatArea, \"ghI2oNiTtGI/3oC8bio2BCLRmzk=\", true, function () {\n  return [useAtom, useAtom, useAtom, useAtom, useAtom];\n});\n_c = ChatArea;\nvar _c;\n$RefreshReg$(_c, \"ChatArea\");","map":{"version":3,"names":["SpeechBubble","chatAtom","UserAtom","useAtom","useState","useRef","useEffect","socket","jsxDEV","_jsxDEV","ChatArea","_s2","_s","$RefreshSig$","_roomList$focusRoom2","_roomList$focusRoom2$","focusRoom","focusRoomAtom","roomList","setRoomList","roomListAtom","userList","userListAtom","message","setMessage","userInfo","adminConsole","adminConsoleAtom","defaultText","useAutoFocus","inputRef","current","focus","chatAreaRef","handleSendMessage","tempMessage","trim","_roomList$focusRoom","roomType","emitDM","emitMessage","handleEnterEvent","e","key","className","children","nickName","isMe","text","fileName","_jsxFileName","lineNumber","columnNumber","detail","messageList","map","userId","userDisplayName","userName","number","type","ref","maxLength","value","onChange","target","onKeyPress","onClick","_c","$RefreshReg$"],"sources":["/data/front/src/components/ChatPage/ChatArea.tsx"],"sourcesContent":["import \"../../styles/ChatArea.css\";\nimport SpeechBubble from \"../objects/SpeechBubble\";\nimport * as chatAtom from '../atom/ChatAtom';\nimport { UserAtom } from \"../atom/UserAtom\";\nimport { useAtom } from 'jotai';\nimport { keyboardKey } from '@testing-library/user-event';\nimport { useState, useRef, useEffect } from 'react';\nimport * as socket from \"../../socket/chat.socket\";\n\nexport default function ChatArea() {\n  const [focusRoom,] = useAtom(chatAtom.focusRoomAtom);\n  const [roomList, setRoomList] = useAtom(chatAtom.roomListAtom);\n  const [userList,] = useAtom(chatAtom.userListAtom);\n  const [message, setMessage] = useState('');\n  const [userInfo,] = useAtom(UserAtom);\n  const [adminConsole] = useAtom(chatAtom.adminConsoleAtom);\n  const defaultText: string = \"채팅방을 선택해주세요. 방을 만들거나, 참여하면 채팅을 할 수 있습니다.\";\n\n  const useAutoFocus = () => {\n    const inputRef = useRef<HTMLInputElement>(null);\n\n    useEffect(() => {\n      if (inputRef.current) {\n        inputRef.current.focus();\n      }\n    }, [focusRoom]);\n\n    return inputRef;\n  };\n\n  const chatAreaRef = useAutoFocus();\n\n\n  const handleSendMessage = () => {\n    const tempMessage = message.trim();\n    if (tempMessage !== '') {\n      if (roomList[focusRoom]?.roomType === 'dm') {\n        socket.emitDM(adminConsole, focusRoom, tempMessage);\n      } else {\n        socket.emitMessage({ adminConsole, roomList }, focusRoom, tempMessage);\n      }\n    }\n    setMessage('');\n  }\n\n  const handleEnterEvent = (e: keyboardKey) => {\n    if (e.key === 'Enter') {\n      handleSendMessage();\n    }\n  }\n\n  return (\n    <div className=\"ChatAreaBG\">\n      <div className=\"ChatBubbleArea\">\n        {\n          focusRoom === -1\n            ?\n            <SpeechBubble key=\"-42\" nickName=\"Norminette\" isMe={false}\n              text={defaultText}\n            />\n            :\n            roomList[focusRoom]?.detail?.messageList!.map((key) => (\n              <SpeechBubble\n                key={key.number}\n                // nickName={userList[key.userId]?.userDisplayName}\n                nickName={userList[key.userId].userDisplayName || key.userName}\n                text={key.message}\n                isMe={key.isMe}\n              />\n            ))\n        }\n      </div>\n      <input type=\"text\" ref={chatAreaRef} className=\"ChatAreaInput\" maxLength={256} value={message} onChange={(e) => setMessage(e.target.value)} onKeyPress={(e) => handleEnterEvent(e)}></input>\n      <div className=\"ChatDMImg\" onClick={handleSendMessage} />\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}