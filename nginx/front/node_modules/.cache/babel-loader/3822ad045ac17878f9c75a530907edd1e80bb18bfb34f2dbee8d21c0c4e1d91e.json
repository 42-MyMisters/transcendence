{"ast":null,"code":"var _jsxFileName = \"/data/front/src/components/ProfilePage/ChangeImageModal.tsx\",\n  _s = $RefreshSig$();\nimport { useAtomValue, useSetAtom } from \"jotai\";\nimport { useRef, useState } from \"react\";\nimport { useNavigate } from 'react-router-dom';\nimport * as chatAtom from \"../../components/atom/ChatAtom\";\nimport { refreshTokenAtom } from \"../../components/atom/LoginAtom\";\nimport { changeImageModalAtom } from \"../../components/atom/ModalAtom\";\nimport * as api from '../../event/api.request';\nimport { AdminLogPrinter, PressKey } from \"../../event/event.util\";\nimport { UserAtom } from \"../atom/UserAtom\";\nimport \"../../styles/ChangeImageModal.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ChangeImageModal() {\n  _s();\n  const setchangeImageModal = useSetAtom(changeImageModalAtom);\n  const setUserInfo = useSetAtom(UserAtom);\n  const [newImage, setnewImage] = useState(\"\");\n  const adminConsole = useAtomValue(chatAtom.adminConsoleAtom);\n  const setRefreshToken = useSetAtom(refreshTokenAtom);\n  const profileRef = useRef(null);\n  const navigate = useNavigate();\n  PressKey([\"Escape\"], () => {\n    setchangeImageModal(false);\n  });\n  const handleChangeImage = () => {\n    var _profileRef$current, _profileRef$current$f;\n    if ((_profileRef$current = profileRef.current) !== null && _profileRef$current !== void 0 && (_profileRef$current$f = _profileRef$current.files) !== null && _profileRef$current$f !== void 0 && _profileRef$current$f[0]) {\n      var _profileRef$current2;\n      const newImg = URL.createObjectURL((_profileRef$current2 = profileRef.current) === null || _profileRef$current2 === void 0 ? void 0 : _profileRef$current2.files[0]);\n      setnewImage(newImg);\n      AdminLogPrinter(adminConsole, `new Image: ${newImg}`);\n    }\n  };\n  const logOutHandler = () => {\n    api.LogOut(adminConsole, setRefreshToken, navigate, \"/\");\n  };\n  async function getMyinfoHandler() {\n    const getMeResponse = await api.GetMyInfo(adminConsole, setUserInfo);\n    if (getMeResponse === 401) {\n      const refreshResponse = await api.RefreshToken(adminConsole);\n      if (refreshResponse !== 201) {\n        logOutHandler();\n      } else {\n        const getMeResponse = await api.GetMyInfo(adminConsole, setUserInfo);\n        if (getMeResponse === 401) {\n          logOutHandler();\n        }\n      }\n    }\n  }\n  const changeNewImageHandler = async () => {\n    var _profileRef$current3, _profileRef$current3$, _profileRef$current4, _profileRef$current4$;\n    if (newImage === \"\") {\n      alert(\"이미지를 선택해주세요.\");\n      return;\n    }\n    const formData = new FormData();\n    formData.append(\"profileImage\", (_profileRef$current3 = profileRef.current) === null || _profileRef$current3 === void 0 ? void 0 : (_profileRef$current3$ = _profileRef$current3.files) === null || _profileRef$current3$ === void 0 ? void 0 : _profileRef$current3$[0]);\n    AdminLogPrinter(adminConsole, (_profileRef$current4 = profileRef.current) === null || _profileRef$current4 === void 0 ? void 0 : (_profileRef$current4$ = _profileRef$current4.files) === null || _profileRef$current4$ === void 0 ? void 0 : _profileRef$current4$[0].name);\n    const changeNickNameRes = await api.changeProfileImage(adminConsole, formData, getMyinfoHandler);\n    if (changeNickNameRes === 401) {\n      const refreshResponse = await api.RefreshToken(adminConsole);\n      if (refreshResponse !== 201) {\n        logOutHandler();\n      } else {\n        const changeNickNameRes = await api.changeProfileImage(adminConsole, formData, getMyinfoHandler);\n        if (changeNickNameRes === 401) {\n          logOutHandler();\n        } else {\n          setchangeImageModal(false);\n          setnewImage(\"\");\n        }\n      }\n    } else {\n      setchangeImageModal(false);\n      setnewImage(\"\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ChangeImageModalBG\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ChangeImageModal\",\n      children: [/*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"ChangeImageForm\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"newImage\",\n          children: \"New Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"newImage\",\n          type: \"file\",\n          accept: \".jpg,.jpeg,.png\",\n          multiple: false,\n          onChange: handleChangeImage,\n          ref: profileRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"ChangeImage\",\n        onClick: changeNewImageHandler,\n        children: \"Change\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ChangeImageCancel\",\n        onClick: () => setchangeImageModal(false),\n        children: \"Cancel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(ChangeImageModal, \"dp/UyGPpIVFLZqrRo/4EJhRwVC0=\", false, function () {\n  return [useSetAtom, useSetAtom, useAtomValue, useSetAtom, useNavigate];\n});\n_c = ChangeImageModal;\nvar _c;\n$RefreshReg$(_c, \"ChangeImageModal\");","map":{"version":3,"names":["useAtomValue","useSetAtom","useRef","useState","useNavigate","chatAtom","refreshTokenAtom","changeImageModalAtom","api","AdminLogPrinter","PressKey","UserAtom","jsxDEV","_jsxDEV","Fragment","_Fragment","ChangeImageModal","_s","setchangeImageModal","setUserInfo","newImage","setnewImage","adminConsole","adminConsoleAtom","setRefreshToken","profileRef","navigate","handleChangeImage","_profileRef$current","_profileRef$current$f","current","files","_profileRef$current2","newImg","URL","createObjectURL","logOutHandler","LogOut","getMyinfoHandler","getMeResponse","GetMyInfo","refreshResponse","RefreshToken","changeNewImageHandler","_profileRef$current3","_profileRef$current3$","_profileRef$current4","_profileRef$current4$","alert","formData","FormData","append","name","changeNickNameRes","changeProfileImage","children","className","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","id","type","accept","multiple","onChange","ref","onClick","_c","$RefreshReg$"],"sources":["/data/front/src/components/ProfilePage/ChangeImageModal.tsx"],"sourcesContent":["import { useAtomValue, useSetAtom } from \"jotai\";\nimport { useRef, useState } from \"react\";\nimport { useNavigate } from 'react-router-dom';\nimport * as chatAtom from \"../../components/atom/ChatAtom\";\nimport { refreshTokenAtom } from \"../../components/atom/LoginAtom\";\nimport { changeImageModalAtom } from \"../../components/atom/ModalAtom\";\nimport * as api from '../../event/api.request';\nimport { AdminLogPrinter, PressKey } from \"../../event/event.util\";\nimport { UserAtom } from \"../atom/UserAtom\";\n\nimport \"../../styles/ChangeImageModal.css\";\n\nexport default function ChangeImageModal() {\n  const setchangeImageModal = useSetAtom(changeImageModalAtom);\n  const setUserInfo = useSetAtom(UserAtom);\n  const [newImage, setnewImage] = useState(\"\");\n  const adminConsole = useAtomValue(chatAtom.adminConsoleAtom);\n  const setRefreshToken = useSetAtom(refreshTokenAtom);\n  const profileRef = useRef<HTMLInputElement>(null);\n  const navigate = useNavigate();\n\n  PressKey([\"Escape\"], () => {\n    setchangeImageModal(false);\n  });\n\n  const handleChangeImage = () => {\n    if (profileRef.current?.files?.[0]) {\n      const newImg = URL.createObjectURL(profileRef.current?.files[0]);\n      setnewImage(newImg);\n      AdminLogPrinter(adminConsole, `new Image: ${newImg}`);\n    }\n  };\n\n  const logOutHandler = () => {\n    api.LogOut(adminConsole, setRefreshToken, navigate, \"/\");\n  };\n\n  async function getMyinfoHandler() {\n    const getMeResponse = await api.GetMyInfo(adminConsole, setUserInfo);\n    if (getMeResponse === 401) {\n      const refreshResponse = await api.RefreshToken(adminConsole);\n      if (refreshResponse !== 201) {\n        logOutHandler();\n      } else {\n        const getMeResponse = await api.GetMyInfo(adminConsole, setUserInfo);\n        if (getMeResponse === 401) {\n          logOutHandler();\n        }\n      }\n    }\n  }\n\n  const changeNewImageHandler = async () => {\n    if (newImage === \"\") {\n      alert(\"이미지를 선택해주세요.\");\n      return;\n    }\n    const formData = new FormData();\n    formData.append(\"profileImage\", profileRef.current?.files?.[0]!);\n    AdminLogPrinter(adminConsole, profileRef.current?.files?.[0]!.name);\n\n    const changeNickNameRes = await api.changeProfileImage(adminConsole, formData, getMyinfoHandler);\n    if (changeNickNameRes === 401) {\n      const refreshResponse = await api.RefreshToken(adminConsole);\n      if (refreshResponse !== 201) {\n        logOutHandler();\n      } else {\n        const changeNickNameRes = await api.changeProfileImage(adminConsole, formData, getMyinfoHandler);\n        if (changeNickNameRes === 401) {\n          logOutHandler();\n        } else {\n          setchangeImageModal(false);\n          setnewImage(\"\");\n        }\n      }\n    } else {\n      setchangeImageModal(false);\n      setnewImage(\"\");\n    }\n  };\n\n  return (\n    <>\n      <div className=\"ChangeImageModalBG\"></div>\n      <div className=\"ChangeImageModal\">\n        <form className=\"ChangeImageForm\">\n          <label htmlFor=\"newImage\">New Image</label>\n          <input\n            id=\"newImage\"\n            type=\"file\"\n            accept=\".jpg,.jpeg,.png\"\n            multiple={false}\n            onChange={handleChangeImage}\n            ref={profileRef}\n          ></input>\n        </form>\n        <button type=\"submit\" className=\"ChangeImage\" onClick={changeNewImageHandler}  >\n          Change\n        </button>\n        <button className=\"ChangeImageCancel\" onClick={() => setchangeImageModal(false)}>\n          Cancel\n        </button>\n      </div>\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}